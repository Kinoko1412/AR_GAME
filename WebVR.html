<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Mobile VR View</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
</head>
<body>
    <a-scene vr-mode-ui="enabled: false" renderer="antialias: true;">
        <a-assets>
            <video id="video" autoplay loop="true" crossorigin="anonymous"></video>
        </a-assets>

        <a-camera id="camera" look-controls="true" wasd-controls-enabled="false"></a-camera>

        <a-videosphere src="#video" rotation="0 180 0"></a-videosphere>
    </a-scene>

    <script>
        // 使用 WebRTC 獲取裝置後鏡頭視頻流
        navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
            .then(function(stream) {
                var video = document.getElementById('video');
                video.srcObject = stream;
            })
            .catch(function(error) {
                console.error("Cannot access camera: ", error);
            });

        // 監聽裝置的方向變化
        window.addEventListener('deviceorientation', function(event) {
            var alpha = event.alpha; // Z 軸
            var beta = event.beta;  // X 軸
            var gamma = event.gamma; // Y 軸

            // 根據裝置方向旋轉視頻球面
            var videosphere = document.querySelector('a-videosphere');
            if (videosphere) {
                videosphere.setAttribute('rotation', {x: -beta, y: -alpha, z: -gamma});
            }
        }, true);
    </script>
</body>
</html>
